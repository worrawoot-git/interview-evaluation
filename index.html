<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏ô‡∏¥‡∏™‡∏¥‡∏ï</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f3f4f6;
        }
        .a4-page {
            width: 210mm;
            min-height: 297mm;
            padding: 25.4mm; /* APA Standard 1 inch margin */
            margin: 10mm auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
        }
        @media print {
            body { background: none; }
            .a4-page { margin: 0; box-shadow: none; width: 100%; padding: 25.4mm; }
            .no-print { display: none; }
        }
        input[type="number"]::-webkit-inner-spin-button, 
        input[type="number"]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        /* Table Styles specifically for Word Export compatibility */
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid black; padding: 8px; vertical-align: middle; }
    </style>
</head>
<body>

    <div class="container mx-auto p-4 no-print text-center">
        <h1 class="text-2xl font-bold mb-4 text-gray-700">‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</h1>
        <div class="flex justify-center gap-4 flex-wrap">
            <button onclick="togglePreview()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded shadow">
                üëÅÔ∏è ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
            </button>
            <button onclick="exportToWord()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow">
                üíæ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î MS Word (APA Format)
            </button>
            <button onclick="resetForm()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded shadow">
                üîÑ Reset ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            </button>
        </div>
    </div>

    <div id="document-area" class="a4-page mx-auto">
        <!-- Header Section -->
        <div class="text-center mb-8">
            <h2 class="text-xl font-bold">‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</h2>
            <p class="text-gray-600 text-sm">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</p>
        </div>

        <!-- Form Section 1: General Info -->
        <div class="grid grid-cols-12 gap-4 mb-6 text-sm">
            <div class="col-span-8">
                <label class="block font-bold mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£:</label>
                <input type="text" id="applicantName" class="w-full border-b border-gray-400 outline-none focus:border-blue-500 px-1" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
            </div>
            <div class="col-span-4">
                <label class="block font-bold mb-1">ID (‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£):</label>
                <input type="text" id="applicantID" class="w-full border-b border-gray-400 outline-none focus:border-blue-500 px-1" placeholder="‡πÄ‡∏ä‡πà‡∏ô 66xxxxxxxx">
            </div>

            <div class="col-span-6">
                <label class="block font-bold mb-1">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£:</label>
                <div class="flex items-center gap-2">
                    <select id="program" class="w-full border rounded p-1 bg-white">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ --</option>
                        <option value="‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á">‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</option>
                        <option value="‡∏£‡∏±‡∏ê‡∏õ‡∏£‡∏∞‡∏®‡∏≤‡∏™‡∏ô‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå">‡∏£‡∏±‡∏ê‡∏õ‡∏£‡∏∞‡∏®‡∏≤‡∏™‡∏ô‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
                        <option value="‡∏£‡∏±‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏î‡∏∏‡∏©‡∏é‡∏µ‡∏ö‡∏±‡∏ì‡∏ë‡∏¥‡∏ï">‡∏£‡∏±‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏î‡∏∏‡∏©‡∏é‡∏µ‡∏ö‡∏±‡∏ì‡∏ë‡∏¥‡∏ï</option>
                    </select>
                    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏ß‡∏Å ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Modal -->
                    <button type="button" onclick="openAddProgramModal()" class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-green-600 no-print" title="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÉ‡∏´‡∏°‡πà">+</button>
                </div>
            </div>
            <div class="col-span-6">
                <label class="block font-bold mb-1">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</label>
                <select id="educationLevel" class="w-full border rounded p-1 bg-white">
                    <option value="‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ">‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ</option>
                    <option value="‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÇ‡∏ó">‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÇ‡∏ó</option>
                    <option value="‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÄ‡∏≠‡∏Å">‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÄ‡∏≠‡∏Å</option>
                </select>
            </div>

            <div class="col-span-12 md:col-span-6">
                <label class="block font-bold mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå:</label>
                <input type="text" id="location" class="w-full border-b border-gray-400 outline-none px-1" value="‡∏Ñ‡∏ì‡∏∞‡∏£‡∏±‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏Ø ‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå 1">
            </div>
            <div class="col-span-6 md:col-span-3">
                <label class="block font-bold mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå:</label>
                <input type="date" id="interviewDate" class="w-full border rounded px-1">
            </div>
            <div class="col-span-6 md:col-span-3">
                <label class="block font-bold mb-1">‡πÄ‡∏ß‡∏•‡∏≤:</label>
                <input type="time" id="interviewTime" class="w-full border rounded px-1">
            </div>
            
            <div class="col-span-12">
                <label class="block font-bold mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å):</label>
                <input type="text" id="interviewerName" class="w-full border-b border-gray-400 outline-none px-1" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå">
            </div>
        </div>

        <!-- Section 2: Scoring Table -->
        <div class="mb-6">
            <table class="w-full text-sm border border-black">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="border border-black p-2 w-3/4 text-left">‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</th>
                        <th class="border border-black p-2 w-1/4 text-center">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ -->
                    <tr>
                        <td class="border border-black p-2 font-bold bg-gray-50">1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ</td>
                        <td class="border border-black bg-gray-50"></td>
                    </tr>
                    
                    <!-- 1.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ -->
                    <tr>
                        <td class="border border-black p-2 pl-6 font-semibold">1.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (100)</td>
                        <td class="border border-black bg-gray-50"></td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-10">1.1.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="50" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="1.1">
                        </td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-10">1.1.2 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÇ‡∏•‡∏Å</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="50" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="1.1">
                        </td>
                    </tr>
                    <tr class="bg-gray-200">
                        <td class="border border-black p-2 text-center font-bold">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 1.1</td>
                        <td class="border border-black p-2 text-center font-bold" id="total-1.1">0</td>
                    </tr>

                    <!-- 1.2 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ -->
                    <tr>
                        <td class="border border-black p-2 pl-6 font-semibold">1.2 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ (100)</td>
                        <td class="border border-black bg-gray-50"></td>
                    </tr>
                    
                    <!-- Group: Public Admin -->
                    <tr>
                        <td class="border border-black p-2 pl-10 italic text-gray-600">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏£‡∏±‡∏ê‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</td>
                        <td class="border border-black bg-gray-50"></td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-12">1.2.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏î‡πâ‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡πÑ‡∏ó‡∏¢</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="33" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="1.2">
                        </td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-12">1.2.2 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="33" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="1.2">
                        </td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-12">1.2.3 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏î‡πâ‡∏≤‡∏ô‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="34" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="1.2">
                        </td>
                    </tr>

                     <!-- Group: Politics -->
                     <tr>
                        <td class="border border-black p-2 pl-10 italic text-gray-600">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏≤‡∏Ç‡∏≤)</td>
                        <td class="border border-black bg-gray-50"></td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-12">1.2.4 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡πÑ‡∏ó‡∏¢</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="33" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="1.2">
                        </td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-12">1.2.5 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏±‡∏ä‡∏ç‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="33" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="1.2">
                        </td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-12">1.2.6 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡∏ä‡∏ô</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="34" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="1.2">
                        </td>
                    </tr>
                    <tr class="bg-gray-200">
                        <td class="border border-black p-2 text-center font-bold">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 1.2</td>
                        <td class="border border-black p-2 text-center font-bold" id="total-1.2">0</td>
                    </tr>

                    <!-- 2. ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏¥‡∏Å‡∏†‡∏≤‡∏û -->
                    <tr>
                        <td class="border border-black p-2 font-bold bg-gray-50">2. ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏¥‡∏Å‡∏†‡∏≤‡∏û (100)</td>
                        <td class="border border-black bg-gray-50"></td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-6">2.1 ‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="33" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="2">
                        </td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-6">2.2 ‡∏ó‡πà‡∏ß‡∏á‡∏ó‡∏µ ‡∏ß‡∏≤‡∏à‡∏≤</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="33" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="2">
                        </td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-6">2.3 ‡∏°‡∏≤‡∏£‡∏¢‡∏≤‡∏ó</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="34" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="2">
                        </td>
                    </tr>
                    <tr class="bg-gray-200">
                        <td class="border border-black p-2 text-center font-bold">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 2</td>
                        <td class="border border-black p-2 text-center font-bold" id="total-2">0</td>
                    </tr>

                    <!-- 3. ‡πÄ‡∏ä‡∏≤‡∏ß‡πå‡∏õ‡∏±‡∏ç‡∏ç‡∏≤ -->
                    <tr>
                        <td class="border border-black p-2 font-bold bg-gray-50">3. ‡πÄ‡∏ä‡∏≤‡∏ß‡πå‡∏õ‡∏±‡∏ç‡∏ç‡∏≤ ‡πÑ‡∏´‡∏ß‡∏û‡∏£‡∏¥‡∏ö (100)</td>
                        <td class="border border-black bg-gray-50"></td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-6">3.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="50" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="3">
                        </td>
                    </tr>
                    <tr>
                        <td class="border border-black p-2 pl-6">3.2 ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤</td>
                        <td class="border border-black p-0">
                            <input type="number" min="0" max="50" class="score-input w-full h-full text-center p-2 outline-none" oninput="calcScores()" data-group="3">
                        </td>
                    </tr>
                    <tr class="bg-gray-200">
                        <td class="border border-black p-2 text-center font-bold">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 3</td>
                        <td class="border border-black p-2 text-center font-bold" id="total-3">0</td>
                    </tr>

                    <!-- Grand Total -->
                    <tr class="bg-blue-100">
                        <td class="border border-black p-2 text-center font-extrabold text-lg">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                        <td class="border border-black p-2 text-center font-extrabold text-lg" id="grand-total">0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Section 3: Text Areas -->
        <div class="mb-6 space-y-4 text-sm">
            <div>
                <label class="block font-bold mb-1">‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ß‡∏¥‡∏à‡∏±‡∏¢:</label>
                <textarea id="researchExp" rows="3" class="w-full border border-gray-400 rounded p-2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤..."></textarea>
            </div>
            <div>
                <label class="block font-bold mb-1">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢ (Thesis/IS Topic):</label>
                <textarea id="researchTopic" rows="2" class="w-full border border-gray-400 rounded p-2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à..."></textarea>
            </div>
        </div>

        <!-- Section 4: Decision -->
        <div class="mb-6 border border-gray-400 p-4 rounded bg-white">
            <h3 class="font-bold mb-3 border-b pb-1">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h3>
            <div class="flex gap-8 mb-4">
                <label class="flex items-center cursor-pointer">
                    <input type="radio" name="decision" value="accept" class="w-5 h-5 text-green-600">
                    <span class="ml-2 font-bold text-green-700">‡∏™‡∏°‡∏Ñ‡∏ß‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï</span>
                </label>
                <label class="flex items-center cursor-pointer">
                    <input type="radio" name="decision" value="reject" class="w-5 h-5 text-red-600">
                    <span class="ml-2 font-bold text-red-700">‡πÑ‡∏°‡πà‡∏™‡∏°‡∏Ñ‡∏ß‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï</span>
                </label>
            </div>
            <div>
                <label class="block font-bold mb-1">‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
                <textarea id="comments" rows="3" class="w-full border border-gray-300 rounded p-2 bg-gray-50"></textarea>
            </div>
        </div>

        <!-- Signature Section (Updated: Independent Input) -->
        <div class="flex justify-end mt-12 pb-8">
            <div class="text-center w-72">
                <!-- Signature Line -->
                 <div class="mb-2 h-8"></div> 
                <div class="flex items-center justify-center">
                    ( <input type="text" id="signerName" class="w-48 text-center border-b border-black outline-none bg-transparent" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå"> )
                </div>
                <p class="font-bold text-sm mt-1">‡∏ú‡∏π‡πâ‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</p>
            </div>
        </div>
    </div>

    <!-- Modal for adding program -->
    <div id="addProgramModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden flex items-center justify-center no-print" style="z-index: 50;">
        <div class="bg-white p-6 rounded shadow-lg w-96">
            <h3 class="text-lg font-bold mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÉ‡∏´‡∏°‡πà</h3>
            <input type="text" id="newProgramInput" class="w-full border p-2 mb-4 rounded" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£...">
            <div class="flex justify-end gap-2">
                <button onclick="closeAddProgramModal()" class="bg-gray-300 hover:bg-gray-400 px-4 py-2 rounded">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button onclick="confirmAddProgram()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <script>
        // 1. New Modal Logic for Adding Program
        function openAddProgramModal() {
            document.getElementById('addProgramModal').classList.remove('hidden');
            setTimeout(() => document.getElementById('newProgramInput').focus(), 100);
        }

        function closeAddProgramModal() {
            document.getElementById('addProgramModal').classList.add('hidden');
            document.getElementById('newProgramInput').value = '';
        }

        function confirmAddProgram() {
            const input = document.getElementById('newProgramInput');
            const newProgram = input.value;
            if (newProgram && newProgram.trim() !== "") {
                const select = document.getElementById('program');
                const option = document.createElement("option");
                option.text = newProgram;
                option.value = newProgram;
                select.add(option);
                select.value = newProgram; // Select the new option automatically
                closeAddProgramModal();
            } else {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£");
            }
        }

        // Calculate Scores
        function calcScores() {
            let total1_1 = sumGroup('1.1');
            let total1_2 = sumGroup('1.2');
            let total2 = sumGroup('2');
            let total3 = sumGroup('3');

            document.getElementById('total-1.1').innerText = total1_1;
            document.getElementById('total-1.2').innerText = total1_2;
            document.getElementById('total-2').innerText = total2;
            document.getElementById('total-3').innerText = total3;

            document.getElementById('grand-total').innerText = total1_1 + total1_2 + total2 + total3;
        }

        function sumGroup(groupName) {
            let sum = 0;
            const inputs = document.querySelectorAll(`.score-input[data-group="${groupName}"]`);
            inputs.forEach(input => {
                const val = parseFloat(input.value);
                if (!isNaN(val)) {
                    sum += val;
                }
            });
            return sum;
        }

        // Toggle Preview Mode (ReadOnly)
        let isPreview = false;
        function togglePreview() {
            isPreview = !isPreview;
            const inputs = document.querySelectorAll('input, select, textarea');
            const docArea = document.getElementById('document-area');
            const btn = document.querySelector('button[onclick="togglePreview()"]');

            if (isPreview) {
                // Switch to Preview
                inputs.forEach(el => {
                    if(el.type !== 'radio') {
                        el.setAttribute('readonly', 'true');
                        if(el.tagName === 'SELECT') el.setAttribute('disabled', 'true');
                        el.classList.add('bg-transparent', 'border-none');
                        el.classList.remove('border', 'border-gray-400', 'bg-white');
                        // Fix for signature line in preview
                        if(el.id === 'signerName') el.classList.remove('border-b'); 
                    }
                });
                docArea.classList.add('shadow-none');
                btn.innerText = "‚úèÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç";
                btn.classList.replace('bg-blue-600', 'bg-yellow-500');
                btn.classList.replace('hover:bg-blue-700', 'hover:bg-yellow-600');
            } else {
                // Switch to Edit
                inputs.forEach(el => {
                     if(el.type !== 'radio') {
                        el.removeAttribute('readonly');
                        if(el.tagName === 'SELECT') el.removeAttribute('disabled');
                        el.classList.remove('bg-transparent', 'border-none');
                        
                        if(el.tagName === 'INPUT' && el.type === 'text') {
                             if(el.id === 'signerName') el.classList.add('border-b');
                             else el.classList.add('border-b', 'border-gray-400');
                        }
                        else if(el.classList.contains('score-input')) {} 
                        else el.classList.add('border', 'border-gray-400');
                     }
                });
                docArea.classList.remove('shadow-none');
                btn.innerText = "üëÅÔ∏è ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç";
                btn.classList.replace('bg-yellow-500', 'bg-blue-600');
                btn.classList.replace('hover:bg-yellow-600', 'hover:bg-blue-700');
            }
        }

        function resetForm() {
            if(confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
                document.querySelectorAll('input').forEach(i => {
                    if(i.type === 'radio' || i.type === 'checkbox') i.checked = false;
                    else i.value = '';
                });
                document.querySelectorAll('select, textarea').forEach(i => i.value = '');
                calcScores();
                if(isPreview) togglePreview(); // exit preview mode
            }
        }

        // Export to Word with APA-like Styling
        function exportToWord() {
            const originalContent = document.getElementById('document-area').cloneNode(true);
            
            // Convert inputs to text for Word
            const inputs = originalContent.querySelectorAll('input, textarea, select');
            inputs.forEach(input => {
                const value = input.value;
                const span = document.createElement('span');
                
                if (input.type === 'radio') {
                    if(input.checked) {
                        span.innerText = "‚òí " + input.nextElementSibling.innerText;
                        span.style.fontWeight = "bold";
                    } else {
                         span.innerText = "‚òê " + input.nextElementSibling.innerText;
                    }
                     input.parentElement.replaceWith(span);
                } else if(input.tagName === 'SELECT') {
                     span.innerText = input.options[input.selectedIndex]?.text || '';
                     input.replaceWith(span);
                } else {
                    span.innerText = value;
                    // Handle Signature input specifically
                    if(input.id === 'signerName') {
                         if(value.trim() === '') span.innerText = "........................................";
                         span.style.textAlign = 'center';
                         span.style.display = 'inline-block';
                         span.style.width = '200px';
                    }
                    if(input.classList.contains('score-input')) {
                        span.style.display = 'block';
                        span.style.textAlign = 'center';
                    }
                    input.replaceWith(span);
                }
            });

            // Remove visual-only elements
            const noPrints = originalContent.querySelectorAll('.no-print');
            noPrints.forEach(el => el.remove());

            // APA / Formal Document Styling
            const css = `
                <style>
                    @page {
                        size: A4;
                        margin: 2.54cm; /* APA 1 inch margin */
                    }
                    body {
                        font-family: 'TH Sarabun New', 'TH SarabunPSK', 'Times New Roman', serif;
                        font-size: 16pt;
                        line-height: 1.5;
                        color: #000;
                    }
                    h1, h2, h3 { font-weight: bold; }
                    table { border-collapse: collapse; width: 100%; margin-bottom: 12pt; }
                    td, th { border: 1px solid black; padding: 4pt; vertical-align: top; font-size: 14pt; }
                    .text-center { text-align: center; }
                    .font-bold { font-weight: bold; }
                    .flex { display: flex; } /* Word support for flex is poor, but kept for fallback */
                </style>
            `;

            const preHtml = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Interview Assessment</title>" + css + "</head><body>";
            const postHtml = "</body></html>";
            const html = preHtml + originalContent.innerHTML + postHtml;

            const blob = new Blob(['\ufeff', html], {
                type: 'application/msword'
            });
            
            const url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);
            const downloadLink = document.createElement("a");
            document.body.appendChild(downloadLink);
            
            if(navigator.msSaveOrOpenBlob ){
                navigator.msSaveOrOpenBlob(blob, 'interview_result_apa.doc');
            } else {
                downloadLink.href = url;
                downloadLink.download = 'interview_result_apa.doc';
                downloadLink.click();
            }
            
            document.body.removeChild(downloadLink);
        }
    </script>
</body>
</html>
